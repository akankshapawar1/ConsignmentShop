<!-- <!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Store Management</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>

    <h1>Welcome <span>Store Owner</span></h1>

    <div class="button">Create Store</div>
    <div class="button">Add Computer</div>
    <div class="button">Modify Price or Delete Computer</div>
    <div class="button">Generate Inventory</div>
    <div class="button">Remove Store</div>

</body>

</html> -->


<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Store Management</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <h1>Welcome <span id="ownerName">Store Owner</span></h1>

    <div class="button" id="createStoreBtn">Create Store</div>
    <div class="button" id="addComputerBtn">Add Computer</div>
    <div class="button">Modify Price or Delete Computer</div>
    <div class="button">Generate Inventory</div>
    <div class="button">Remove Store</div>

    <div id="createStoreForm" class="form">
        <h2>Create Store</h2>
        <label for="storeName">Store ID:</label>
        <input type="text" id="storeID" required>
        <label for="storeName">Store Name:</label>
        <input type="text" id="storeName" required>
        <br>
        <label for="credentials">Credentials:</label>
        <input type="password" id="credentials" required>
        <br>
        <label for="latitude">Latitude:</label>
        <input type="text" id="latitude" required>
        <br>
        <label for="longitude">Longitude:</label>
        <input type="text" id="longitude" required>
        <br>
        <button type="button" onclick="createStore()">Create Store</button>
        <p id="createStoreMessage"></p>
    </div>

    <div id="addComputerForm" class="form">
        <h2>Add Computer</h2>
        <label for="computerID">Your Computer ID:</label>
        <input type="text" id="computerID" required>
        <label for="storeID2">Store ID:</label>
        <input type="number" id="storeID2" required>
        <label for="computerCredentials">Your Credentials:</label>
        <input type="password" id="computerCredentials" required>
        <label for="computerName">Computer Name:</label>
        <input type="text" id="computerName" required>
        <br>
        <label for="price">Price:</label>
        <input type="number" id="price" required>
        <br>
        <label for="memory">Memory:</label>
        <input type="text" id="memory" required>
        <br>
        <label for="storage">Storage:</label>
        <input type="text" id="storage" required>
        <br>
        <label for="processor">Processor:</label>
        <input type="text" id="processor" required>
        <br>
        <label for="processorGeneration">Processor Generation:</label>
        <input type="text" id="processorGeneration" required>
        <br>
        <label for="graphics">Graphics:</label>
        <input type="text" id="graphics" required>
        <br>
        <button type="button" onclick="addComputer()">Add Computer</button>
        <p id="addComputerMessage"></p>
    </div>

    <script>
        document.getElementById('createStoreBtn').addEventListener('click', function () {
            document.getElementById('createStoreForm').style.display = 'block';
            document.getElementById('addComputerForm').style.display = 'none';
        });

        document.getElementById('addComputerBtn').addEventListener('click', function () {
            document.getElementById('addComputerForm').style.display = 'block';
            document.getElementById('createStoreForm').style.display = 'none';
        });

        async function createStore() {
            const storeID = document.getElementById('storeID').value;
            const storeName = document.getElementById('storeName').value;
            const credentials = document.getElementById('credentials').value;
            const latitude = document.getElementById('latitude').value;
            const longitude = document.getElementById('longitude').value;

            const requestBody = { body : JSON.stringify({
                action: "createStore",
                storeID,
                storeName,
                latitude,
                longitude,
                credentials})
             };

        try {
                const response = await fetch('https://q15htzftq3.execute-api.us-east-1.amazonaws.com/beta/login', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(requestBody)
        });
        const responseData = await response.json();
        console.log(response);
        if (responseData.statusCode === 409) {
            document.getElementById('createStoreMessage').innerText = 'Store already exists. Please choose a different name or credentials.';
        }

        else if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
        }

        else{
        document.getElementById('createStoreMessage').innerText = 'Store created successfully!';
        console.log('Store created:', responseData);
        }
    } catch (error) {
        document.getElementById('createStoreMessage').innerText = 'Failed to create store. Please try again.';
        console.error('Error creating store:', error);
    }
}


async function addComputer() {
            const computerID = document.getElementById('computerID').value;
            const storeID = document.getElementById('storeID2').value;
            console.log("store id : ", storeID);
            const credentials = document.getElementById('computerCredentials').value;
            const computerName = document.getElementById('computerName').value;
            const price = document.getElementById('price').value;
            const memory = document.getElementById('memory').value;
            const storage = document.getElementById('storage').value;
            const processor = document.getElementById('processor').value;
            const processorGeneration = document.getElementById('processorGeneration').value;
            const graphics = document.getElementById('graphics').value;

            const computerDetails = {
                computerID,
                computerName,
                price,
                memory,
                storage,
                processor,
                processorGeneration,
                graphics
            };
            const requestBody = { body : JSON.stringify({
                action: "addComputer",
                credentials,
                storeID,
                computerDetails
                })
             };
             console.log(requestBody);
           

             try {
                const response = await fetch('https://q15htzftq3.execute-api.us-east-1.amazonaws.com/beta/login', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(requestBody)
            });

            const responseData = await response.json();
            console.log(responseData);
    // Check if the response is successful.
            if (responseData.statusCode==200) {
                document.getElementById('addComputerMessage').innerText = 'Computer added successfully!';
                console.log('Computer added:', responseData);
            } else {
        // For non-successful responses, use the error message from the backend.
                document.getElementById('addComputerMessage').innerText = responseData.message || 'Failed to add computer. Please try again. Try different username';
            }

        } catch (error) {
    // This is for network errors or invalid JSON parsing.
            document.getElementById('addComputerMessage').innerText = 'Failed to add computer. Please try again. Your credentials might be wrong';
            console.error('Error adding computer:', error);
        }

        }
    </script>
</body>
</html>
